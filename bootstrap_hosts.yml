---
- hosts: all

  tasks:

    - name: install Ansible ssh key
      authorized_key:
        user: vagrant
        key: "{{ lookup('file', '~/.ssh/id_rsa.pub') }}"

    - name: update /etc/hosts
      blockinfile:
          block: "{{ lookup('file', './vagrant/etc_hosts') }}"
          dest: /etc/hosts

    - name: install net-tools
      yum:
        name: net-tools
        state: present

- hosts: ansible

  tasks:
    - name: install ansible
      yum:
          name: ansible
          state: present
          
    - name: install pip
      yum:
          name: pip
          state: present
          
    - name: checkout this repo
      git:
          repo: git@github.com:thisdougb/AnsibleFest2017.git
          dest: /home/vagrant/
      become: no